<!doctype html>
<html lang="fa">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BLZ — گیمینگ | Servers • Tournaments • App</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-1:#03030a;
      --bg-2:#060612;
      --panel:#0f1116aa;
      --neon-cyan:#00f0ff;
      --neon-mag:#ff53c8;
      --accent:#8b5cf6;
      --muted:#9aa3b2;
      --success:#7ef5b3;
      --danger:#ff6b6b;
      --glass-border: rgba(255,255,255,0.04);
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color-scheme: dark;
    }

    /* Full-screen gaming animated background (neon particles + gradient waves) */
    html,body{height:100%;}
    body{
      margin:0;
      min-height:100vh;
      background:
        radial-gradient(1000px 500px at 10% 10%, rgba(0,240,255,0.03), transparent 8%),
        radial-gradient(800px 400px at 90% 80%, rgba(255,83,200,0.03), transparent 8%),
        linear-gradient(180deg,var(--bg-1),var(--bg-2));
      overflow-y:auto;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Animated canvas overlay */
    #bg-canvas{
      position:fixed;left:0;top:0;width:100%;height:100%;z-index:0;pointer-events:none;
      mix-blend-mode:screen;opacity:0.12;
      filter: blur(10px) saturate(120%);
    }

    /* container */
    .container{
      position:relative;z-index:2;
      max-width:1200px;margin:24px auto;padding:24px;box-sizing:border-box;
      display:grid;grid-template-columns: 1fr 360px;gap:22px;
    }

    /* Header */
    header{
      grid-column:1 / -1;display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px;
      padding:18px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
      border:1px solid var(--glass-border);backdrop-filter: blur(6px);
    }
    .brand{
      display:flex;flex-direction:column;
    }
    .brand h1{margin:0;font-size:20px;letter-spacing:1px}
    .brand p{margin:4px 0 0;color:var(--muted);font-size:13px}

    /* Panel buttons */
    .panel-buttons{display:flex;gap:8px;align-items:center}
    .panel-button{
      padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);
      background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      color:var(--neon-cyan);font-weight:700;cursor:pointer;box-shadow:0 8px 30px rgba(2,6,23,0.6);
      transition:transform .14s ease,box-shadow .14s;
    }
    .panel-button:active{transform:translateY(1px)}
    .panel-button.ghost{color:var(--muted);background:transparent;border:1px dashed rgba(255,255,255,0.02)}

    /* layout main + side */
    main.card{
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
      border-radius:14px;padding:18px;border:1px solid var(--glass-border);
      box-shadow: 0 20px 60px rgba(3,6,18,0.6);
      overflow:hidden;
    }
    aside.side{
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
      border-radius:14px;padding:16px;border:1px solid var(--glass-border);
      height:fit-content;position:sticky;top:24px;
    }

    h2.section-title{margin:0 0 12px 0;font-size:18px}
    .desc{color:var(--muted);font-size:13px;margin-bottom:12px}

    /* big neon card for panels */
    .panels{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
    .panel{
      border-radius:12px;padding:14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
      border:1px solid var(--glass-border);position:relative;overflow:hidden;min-height:120px;
      transition:transform .16s ease,box-shadow .16s;
    }
    .panel:hover{transform:translateY(-6px);box-shadow:0 30px 70px rgba(0,0,0,0.6)}
    .panel .title{font-weight:800;font-size:15px}
    .panel .sub{color:var(--muted);font-size:13px;margin-top:8px}

    /* reveal area that slides open — heavily animated (gamey) */
    .reveal{
      height:0;overflow:hidden;opacity:0;pointer-events:none;
      transition: height .5s cubic-bezier(.18,.85,.25,1), opacity .28s ease;
    }
    .reveal.open{
      height:180px;opacity:1;pointer-events:auto;
    }
    .reveal-inner{
      margin-top:12px;border-radius:10px;padding:12px;height:100%;
      background:linear-gradient(90deg, rgba(0,0,0,0.2), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.02);position:relative;overflow:hidden;
    }

    /* flashy motion graphics inside reveal */
    .reveal-inner .fx{
      position:absolute;inset:0;pointer-events:none;
      background: radial-gradient(circle at 20% 10%, rgba(0,240,255,0.04), transparent 6%),
                  radial-gradient(circle at 80% 90%, rgba(255,83,200,0.03), transparent 6%);
      animation: shimmer 6s linear infinite;
      mix-blend-mode:screen;opacity:1;
    }
    @keyframes shimmer{
      0%{transform:translateX(-10px) translateY(0)}
      50%{transform:translateX(18px) translateY(-12px)}
      100%{transform:translateX(-10px) translateY(0)}
    }

    /* Server rows */
    .server-list{display:flex;flex-direction:column;gap:12px}
    .server{
      display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px;border-radius:10px;
      border:1px solid rgba(255,255,255,0.02);background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
    }
    .server .meta{display:flex;gap:10px;align-items:center}
    .badge{
      width:42px;height:42px;border-radius:8px;background:linear-gradient(135deg,var(--neon-cyan),var(--neon-mag));
      display:flex;align-items:center;justify-content:center;font-weight:900;color:#071126;
    }
    .server .info{font-weight:700}
    .server .sub{color:var(--muted);font-size:13px}

    .controls{display:flex;gap:8px;align-items:center}

    /* server-control inside reveal */
    .server-control{
      margin-top:10px;padding:10px;border-radius:10px;background:linear-gradient(90deg, rgba(0,0,0,0.18), rgba(255,255,255,0.00));
      border:1px solid rgba(255,255,255,0.02);display:none;flex-direction:column;gap:10px;
    }
    .server-control.open{display:flex}

    .radios{display:flex;gap:8px}
    .radio{
      padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.03);cursor:pointer;font-weight:700;
      background:transparent;color:var(--muted);
    }
    .radio.active{background:linear-gradient(90deg, rgba(0,240,255,0.06), rgba(255,83,200,0.06));color:var(--neon-cyan);border:1px solid rgba(0,240,255,0.12)}

    /* Connection loading improved: neon progress bar + subtle typed text */
    .conn-box{display:flex;flex-direction:column;gap:8px}
    .conn-line{display:flex;align-items:center;gap:12px}
    .progress{
      position:relative;height:12px;border-radius:999px;background:rgba(255,255,255,0.03);overflow:hidden;border:1px solid rgba(255,255,255,0.02);flex:1;
      box-shadow:inset 0 -6px 24px rgba(0,0,0,0.6);
    }
    .progress .bar{
      position:absolute;left:0;top:0;bottom:0;width:0%;
      background: linear-gradient(90deg,var(--neon-cyan),var(--neon-mag));
      box-shadow:0 6px 30px rgba(139,92,246,0.12);
      border-radius:999px;
      transition:width .2s linear;
    }
    .conn-status{font-weight:800;letter-spacing:0.6px}

    /* messages */
    .msg{padding:8px 10px;border-radius:8px;font-weight:800;text-align:center}
    .msg.success{background:linear-gradient(90deg, rgba(126,245,179,0.08), rgba(255,255,255,0.01));color:var(--success);border:1px solid rgba(126,245,179,0.08)}
    .msg.error{background:linear-gradient(90deg, rgba(255,107,107,0.06), rgba(255,255,255,0.01));color:var(--danger);border:1px solid rgba(255,107,107,0.06)}
    .msg.warn{background:linear-gradient(90deg, rgba(255,237,130,0.06), rgba(255,255,255,0.01));color:#ffd166;border:1px solid rgba(255,237,130,0.06)}

    /* password row */
    .pw-row{display:flex;gap:8px;align-items:center}
    input[type="password"]{background:transparent;border:1px solid rgba(255,255,255,0.03);padding:10px;border-radius:8px;color:inherit;font-weight:700}

    /* Coming soon sticker */
    .coming{
      padding:10px 12px;border-radius:10px;font-weight:900;text-align:center;color:var(--neon-mag);
      border:1px solid rgba(255,83,200,0.08);
      background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
    }

    footer{grid-column:1 / -1;color:var(--muted);font-size:13px;text-align:center;margin-top:12px}

    /* responsive */
    @media (max-width:980px){
      .container{grid-template-columns:1fr;padding:12px}
      .panels{grid-template-columns:1fr}
      aside.side{position:relative;top:auto}
    }
  </style>
</head>
<body>
  <!-- Animated canvas (particles/waves) -->
  <canvas id="bg-canvas"></canvas>

  <div class="container">
    <header>
      <div class="brand">
        <h1>BLZ</h1>
        <p>پلتفرم گیمینگ و سرورهای Minecraft</p>
      </div>

      <div class="panel-buttons" role="toolbar" aria-label="پنل‌ها">
        <button class="panel-button" data-open="panel-servers">پنل سرورها</button>
        <button class="panel-button" data-open="panel-app">پنل اپ</button>
        <button class="panel-button" data-open="panel-tourn">پنل تورنومنت</button>
        <button class="panel-button" data-open="panel-events">پنل ایونت</button>
      </div>
    </header>

    <main class="card" id="main-area" aria-live="polite">
      <h2 class="section-title">داشبورد BLZ</h2>
      <div class="desc">برای باز کردن هر بخش روی دکمه‌ی مربوطه در بالا کلیک کنید. تمامی فعال‌سازی‌ها و جریان‌ها در سمت کاربر شبیه‌سازی شده‌اند.</div>

      <div class="panels">
        <!-- Servers Panel -->
        <div class="panel" id="panel-servers" role="region" aria-labelledby="servers-title" aria-hidden="true">
          <div class="title" id="servers-title">Servers</div>
          <div class="sub">سرورهای Minecraft — آی‌پی‌ها: <span style="font-weight:800">ir</span>, <span style="font-weight:800">ru</span>, <span style="font-weight:800">tr</span></div>

          <div class="reveal" id="reveal-servers">
            <div class="reveal-inner">
              <div class="fx"></div>
              <div class="server-list">
                <!-- Server 01 -->
                <div>
                  <div class="server">
                    <div class="meta">
                      <div class="badge">S1</div>
                      <div>
                        <div class="info">Server 01</div>
                        <div class="sub">IR — Low latency — Minecraft</div>
                      </div>
                    </div>
                    <div class="controls">
                      <button class="panel-button" data-toggle="srv" data-id="1">پنل</button>
                      <button class="panel-button ghost" data-copy="play.blz.ir">کپی IP</button>
                    </div>
                  </div>

                  <div class="server-control" id="srv-control-1" data-server="1" aria-hidden="true">
                    <div class="conn-box">
                      <div class="conn-line">
                        <div class="radios" role="tablist" aria-label="پورتال‌ها">
                          <div class="radio active" data-portal="Portal 1">Portal 1</div>
                          <div class="radio" data-portal="Portal 2">Portal 2</div>
                        </div>
                        <div style="display:flex;gap:8px">
                          <button class="panel-button primary" data-connect="1">Connect</button>
                          <div style="min-width:120px;text-align:right;color:var(--muted);font-weight:700">play.blz.ir</div>
                        </div>
                      </div>

                      <div class="progress" aria-hidden="true">
                        <div class="bar" id="bar-1"></div>
                      </div>
                      <div id="conn-msg-1" class="conn-status"></div>
                    </div>
                  </div>
                </div>

                <!-- Server 02 -->
                <div>
                  <div class="server">
                    <div class="meta">
                      <div class="badge">S2</div>
                      <div>
                        <div class="info">Server 02</div>
                        <div class="sub">RU — Competitive — Minecraft</div>
                      </div>
                    </div>
                    <div class="controls">
                      <button class="panel-button" data-toggle="srv" data-id="2">پنل</button>
                      <button class="panel-button ghost" data-copy="play.blz.ru">کپی IP</button>
                    </div>
                  </div>

                  <div class="server-control" id="srv-control-2" data-server="2" aria-hidden="true">
                    <div class="conn-box">
                      <div class="conn-line">
                        <div class="radios" role="tablist" aria-label="پورتال‌ها">
                          <div class="radio active" data-portal="Portal 1">Portal 1</div>
                          <div class="radio" data-portal="Portal 2">Portal 2</div>
                        </div>
                        <div style="display:flex;gap:8px">
                          <button class="panel-button primary" data-connect="2">Connect</button>
                          <div style="min-width:120px;text-align:right;color:var(--muted);font-weight:700">play.blz.ru</div>
                        </div>
                      </div>

                      <div class="progress" aria-hidden="true">
                        <div class="bar" id="bar-2"></div>
                      </div>
                      <div id="conn-msg-2" class="conn-status"></div>
                    </div>
                  </div>
                </div>

                <!-- Server 03 (Admin) -->
                <div>
                  <div class="server">
                    <div class="meta">
                      <div class="badge">S3</div>
                      <div>
                        <div class="info">Server 03</div>
                        <div class="sub">TR — Admin — Minecraft</div>
                      </div>
                    </div>
                    <div class="controls">
                      <button class="panel-button" data-toggle="srv" data-id="3">پنل</button>
                      <button class="panel-button ghost" data-copy="play.blz.tr">کپی IP</button>
                    </div>
                  </div>

                  <div class="server-control" id="srv-control-3" data-server="3" aria-hidden="true">
                    <div class="pw-row">
                      <input id="admin-pw" type="password" placeholder="رمز عبور ادمین" aria-label="admin password" />
                      <button class="panel-button primary" data-verify="3">ارسال</button>
                    </div>
                    <div id="admin-msg" style="margin-top:8px"></div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>

        <!-- App Panel -->
        <div class="panel" id="panel-app" role="region" aria-labelledby="app-title" aria-hidden="true">
          <div class="title" id="app-title">Anti-Censorship App</div>
          <div class="sub">ابزاری برای عبور از محدودیت‌ها و افزایش حریم خصوصی</div>

          <div class="reveal" id="reveal-app">
            <div class="reveal-inner">
              <div class="fx"></div>
              <div style="display:flex;flex-direction:column;gap:12px;align-items:stretch">
                <div class="coming">به‌زودی! (COMING SOON!)</div>
                <div class="desc">برای باز کردن جزئیات روی دکمه‌ی پنل بالای صفحه کلیک کن.</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tournament Panel -->
        <div class="panel" id="panel-tourn" role="region" aria-labelledby="tourn-title" aria-hidden="true">
          <div class="title" id="tourn-title">Tournament</div>
          <div class="sub">مسابقات و جدول‌ها</div>

          <div class="reveal" id="reveal-tourn">
            <div class="reveal-inner">
              <div class="fx"></div>
              <div class="coming">به‌زودی! (COMING SOON!)</div>
            </div>
          </div>
        </div>

        <!-- Events Panel -->
        <div class="panel" id="panel-events" role="region" aria-labelledby="events-title" aria-hidden="true">
          <div class="title" id="events-title">Events</div>
          <div class="sub">ایونت‌ها و لانچ‌ها</div>

          <div class="reveal" id="reveal-events">
            <div class="reveal-inner">
              <div class="fx"></div>
              <div class="coming">به‌زودی! (COMING SOON!)</div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <aside class="side">
      <div style="margin-bottom:12px">
        <div style="font-weight:900;font-size:16px">پنل کنترل سریع</div>
        <div class="desc" style="margin-top:6px">دکمه‌ی پنل هر بخش در بالا باعث باز شدن بخش مربوطه و افکت‌های گیمینگ می‌شود.</div>
      </div>

      <div style="display:flex;flex-direction:column;gap:8px">
        <button class="panel-button" data-open="panel-servers">باز کردن Servers</button>
        <button class="panel-button" data-open="panel-app">باز کردن App</button>
        <button class="panel-button" data-open="panel-tourn">باز کردن Tournament</button>
        <button class="panel-button" data-open="panel-events">باز کردن Events</button>
      </div>

      <div style="margin-top:12px;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));">
        <div style="font-weight:800">اطلاع</div>
        <div class="desc" style="margin-top:8px">تمامی جریان‌ها در سمت کاربر شبیه‌سازی شده‌اند و برای دموی UI مناسب‌اند.</div>
      </div>
    </aside>

    <footer>© BLZ — همه چیز برای گیمرها طراحی شده</footer>
  </div>

  <script>
    /* ------------------------------
       Background canvas (neon particles + subtle wave)
       ------------------------------ */
    (function(){
      const canvas = document.getElementById('bg-canvas');
      const ctx = canvas.getContext('2d');
      let w = canvas.width = innerWidth;
      let h = canvas.height = innerHeight;

      const particles = [];
      const P = 60;
      for(let i=0;i<P;i++){
        particles.push({
          x: Math.random()*w,
          y: Math.random()*h,
          vx: (Math.random()-0.5)*0.3,
          vy: (Math.random()-0.5)*0.3,
          r: 1 + Math.random()*3,
          hue: 180 + Math.random()*120
        });
      }

      function draw(t){
        ctx.clearRect(0,0,w,h);
        // moving gradient waves
        const g = ctx.createLinearGradient(0, Math.sin(t/6000)*h, w, h - Math.cos(t/8000)*h);
        g.addColorStop(0, 'rgba(0,240,255,0.02)');
        g.addColorStop(0.5, 'rgba(139,92,246,0.015)');
        g.addColorStop(1, 'rgba(255,83,200,0.01)');
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);

        // neon particles
        for(let p of particles){
          p.x += p.vx + Math.sin(t/10000 + p.r)*0.2;
          p.y += p.vy + Math.cos(t/8000 + p.r)*0.2;
          if(p.x < -50) p.x = w+50;
          if(p.x > w+50) p.x = -50;
          if(p.y < -50) p.y = h+50;
          if(p.y > h+50) p.y = -50;

          ctx.beginPath();
          const grd = ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*8);
          grd.addColorStop(0, `hsla(${p.hue},100%,60%,0.18)`);
          grd.addColorStop(1, `hsla(${p.hue},100%,50%,0)`);
          ctx.fillStyle = grd;
          ctx.arc(p.x,p.y,p.r*6,0,Math.PI*2);
          ctx.fill();
        }

        // subtle connecting lines
        for(let i=0;i<40;i++){
          const a = particles[Math.floor(Math.random()*particles.length)];
          const b = particles[Math.floor(Math.random()*particles.length)];
          const dx = a.x-b.x, dy = a.y-b.y, d = Math.sqrt(dx*dx+dy*dy);
          if(d < 220){
            ctx.beginPath();
            ctx.moveTo(a.x,a.y);
            ctx.lineTo(b.x,b.y);
            ctx.strokeStyle = `rgba(120,120,255,${1 - d/220} )`;
            ctx.lineWidth = 0.3;
            ctx.stroke();
          }
        }

        requestAnimationFrame(draw);
      }
      draw();

      addEventListener('resize', ()=>{
        w = canvas.width = innerWidth;
        h = canvas.height = innerHeight;
      });
    })();

    /* ------------------------------
       Helpers & DOM interactions
       ------------------------------ */
    const $ = (s, root=document) => root.querySelector(s);
    const $$ = (s, root=document) => Array.from(root.querySelectorAll(s));

    // Panel open/close logic — panels hidden initially; open reveals with motion
    function openPanel(id){
      // close all reveals first
      ['panel-servers','panel-app','panel-tourn','panel-events'].forEach(pid=>{
        const p = document.getElementById(pid);
        if(!p) return;
        p.setAttribute('aria-hidden','true');
        const rv = p.querySelector('.reveal');
        if(rv) rv.classList.remove('open');
      });

      // open target
      const panel = document.getElementById(id);
      if(!panel) return;
      panel.setAttribute('aria-hidden','false');
      const reveal = panel.querySelector('.reveal');
      if(reveal){
        // small animated pop
        reveal.classList.add('open');
        reveal.querySelector('.reveal-inner').animate([
          { transform: 'translateY(8px) scale(0.98)', opacity:0 },
          { transform: 'translateY(-6px) scale(1.02)', opacity:1 },
          { transform: 'translateY(0) scale(1)', opacity:1 }
        ], { duration:420, easing:'cubic-bezier(.18,.85,.25,1)'});
        reveal.scrollIntoView({behavior:'smooth', block:'center'});
      }
    }

    // wire top buttons & side quick buttons
    $$('[data-open]').forEach(btn=>{
      btn.addEventListener('click', ()=> openPanel(btn.dataset.open));
    });

    // panel-button toggles for server small "پنل" buttons
    $$('[data-toggle="srv"]').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        const id = btn.dataset.id;
        const control = document.getElementById('srv-control-' + id);
        const isOpen = control.classList.contains('open');
        // close others
        [1,2,3].forEach(n=>{
          const c = document.getElementById('srv-control-' + n);
          if(c && n != id) c.classList.remove('open');
        });
        if(isOpen) control.classList.remove('open');
        else {
          control.classList.add('open');
          // smooth scroll control into view
          control.scrollIntoView({behavior:'smooth', block:'center'});
        }
      });
    });

    // radio behaviour inside server controls
    document.addEventListener('click', (e)=>{
      const r = e.target.closest('.radio');
      if(!r) return;
      const parent = r.closest('.server-control');
      if(!parent) return;
      // deactivate siblings
      parent.querySelectorAll('.radio').forEach(rr => rr.classList.remove('active'));
      r.classList.add('active');
    });

    // Copy IP quick buttons
    $$('[data-copy]').forEach(btn=>{
      btn.addEventListener('click', ()=> {
        const txt = btn.dataset.copy;
        try{
          navigator.clipboard?.writeText(txt);
          btn.textContent = 'Copied';
          setTimeout(()=> btn.textContent = 'کپی IP', 1200);
        }catch(e){
          alert('IP: ' + txt);
        }
      });
    });

    /* ------------------------------
       Connection flow: improved progress + outcomes per portal
       Rules (mapping):
         - Server1 (IR): Portal1 -> success, Portal2 -> Error: Timeout
         - Server2 (RU): Portal1 -> Warning unstable, Portal2 -> Error: IP log
         - Server3 (TR): Admin password (12pi) required
       ------------------------------ */

    function setProgress(barEl, percent){
      barEl.style.width = percent + '%';
    }

    function outcomeFor(serverId, portalName){
      // portalName is "Portal 1" or "Portal 2"
      if(serverId === '1'){
        if(portalName === 'Portal 1') return {type:'success', text: 'Connection established'};
        else return {type:'error', text: 'Error: Timeout'};
      }
      if(serverId === '2'){
        if(portalName === 'Portal 1') return {type:'warn', text: 'Warning: Connection unstable'};
        else return {type:'error', text: 'Error: IP log'};
      }
      return {type:'error', text:'Error: Unknown'};
    }

    // wire connect buttons
    $$('[data-connect]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const serverId = btn.dataset.connect;
        const control = document.getElementById('srv-control-' + serverId);
        const bar = document.getElementById('bar-' + serverId);
        const msg = document.getElementById('conn-msg-' + serverId);
        // pick portal
        const active = Array.from(control.querySelectorAll('.radio')).find(r=>r.classList.contains('active'));
        const portal = active ? active.dataset.portal : 'Portal 1';
        // reset
        msg.innerHTML = '';
        setProgress(bar, 0);
        // animate progress over 4s with neon easing
        const duration = 4000;
        const start = performance.now();
        // animated neon shimmer effect on bar via small interval
        function animate(now){
          const t = Math.min(1, (now - start) / duration);
          // ease in-out cubic
          const eased = t<0.5 ? 4*t*t*t : 1 - Math.pow(-2*t+2,3)/2;
          setProgress(bar, Math.round(eased*100));
          // dynamic text update (typed effect) — show "Connection to Portal X..."
          msg.innerHTML = `<span style="opacity:0.95">Connection to ${portal}...</span>`;
          if(t < 1) requestAnimationFrame(animate);
          else {
            // after completion, show outcome
            const res = outcomeFor(serverId, portal);
            if(res.type === 'success'){
              msg.innerHTML = `<div class="msg success">${res.text}</div>`;
              // small neon flash on bar
              bar.style.transition = 'width .2s';
              setTimeout(()=> bar.style.width = '100%', 120);
            } else if(res.type === 'warn'){
              msg.innerHTML = `<div class="msg warn">${res.text}</div>`;
            } else {
              msg.innerHTML = `<div class="msg error">${res.text}</div>`;
            }
            // reset bar slowly after short delay
            setTimeout(()=> { setProgress(bar, 0); }, 1800);
          }
        }
        requestAnimationFrame(animate);
      });
    });

    // Admin verify for server 3
    $$('[data-verify]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const pw = document.getElementById('admin-pw').value || '';
        const adminMsg = document.getElementById('admin-msg');
        adminMsg.innerHTML = '';
        if(pw === '12pi'){
          adminMsg.innerHTML = `<div class="msg success">Code sent to your panel</div>`;
          document.getElementById('admin-pw').value = '';
        } else {
          adminMsg.innerHTML = `<div class="msg error">Incorrect password</div>`;
        }
      });
    });

    /* ------------------------------
       Opening panels via top buttons should focus and animate
       Also allow keyboard (Enter/Space)
       ------------------------------ */
    document.addEventListener('keydown', (e)=>{
      if((e.key === 'Enter' || e.key === ' ') && document.activeElement.matches('.panel-button')){
        e.preventDefault();
        document.activeElement.click();
      }
    });

    // When clicking panel open buttons, show corresponding reveal
    $$('[data-open]').forEach(b=>{
      b.addEventListener('click', ()=>{
        const id = b.dataset.open;
        openPanel(id);

        // focus first interactive element inside panel
        const panel = document.getElementById(id);
        if(!panel) return;
        setTimeout(()=> {
          const f = panel.querySelector('button, input');
          if(f) f.focus();
        }, 450);
      });
    });

    // Initially, show nothing — user must open panels
    ['panel-servers','panel-app','panel-tourn','panel-events'].forEach(pid=>{
      const p = document.getElementById(pid);
      if(p) p.setAttribute('aria-hidden','true');
    });

    // small polish: clicking outside reveals closes server controls
    document.addEventListener('click', (e)=>{
      if(!e.target.closest('.server-control') && !e.target.matches('[data-toggle="srv"]')){
        [1,2,3].forEach(n=>{
          const c = document.getElementById('srv-control-'+n);
          if(c) c.classList.remove('open');
        });
      }
    });

    // Prevent form submission or page reload by Enter in inputs
    document.addEventListener('submit', e => e.preventDefault());
  </script>
</body>
</html>
